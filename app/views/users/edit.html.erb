<%# 郵便番号から住所を自動表示するjavascript %>
<%javascript_include_tag 'ajaxzip3'%>
<script>
window.onload=function(){
  document.getElementById("user_postal_code").addEventListener('keyup', function(){
    AjaxZip3.zip2addr(this, '', 'user[address]', 'user[address]');
    });
  }
</script>

<div class="container">
  <div class="row">
    <div class="col-md-4 col-md-offset-4">
      <h2> ユーザー情報の編集 </h2>
      <br>

      <%= form_for(@user) do |f| %>

        <% if @user.errors.any? %>
          <%= @user.errors.count %>件のエラーが発生しました
          <% @user.errors.full_messages.each do |message| %>
          <%= message %>
          <% end %>
          <% end %>

          <table>
            <tr>
              <th> 名前 ( 漢字 )</th>
              <td><%= f.text_field :name %></td>
            </tr>

            <tr>
              <th> 名前 ( カナ ) </th>
              <td><%= f.text_field :name_kana %></td>
            </tr>

            <tr>
              <th> ユーザー名 </th>
              <td><%= f.text_area :nickname %></td>
            </tr>

            <tr>
              <th> 生年月日 </th>
              <td>
                <%= raw sprintf(f.date_select(
                                  :birthday,
                                  use_month_numbers: true,
                                  start_year:        1930,
                                  end_year:          (Time.now.year - 18),
                                  default:           @user[:birthday],
                                  date_separator: '%s'), '年', '月') + '日' %>
              </td>
            </tr>

            <tr>
              <th> 住所 </th>
              <td>
                〒<%= f.text_field :postal_code %><br>
                <%= f.text_area :address %>
              </td>
            </tr>

            <tr>
              <th> 配送先 </th>
              <td><%= link_to "配送先の追加・編集", destination_index_path %></td>
            </tr>

            <tr>
              <th> 電話番号 </th>
              <td><%= f.text_field :phone_number %></td>
            </tr>

            <tr>
              <th> メールアドレス </th>
              <td><%= f.text_field :email %></td>
            </tr>
          </table>

        <br>
        <br>

        <div class="row">
          <div class="col-md-12  col-md-offset-3">
            <div class="actions form-group">
              <%= f.submit "更新", class:"btn btn-warning" %>
              <%= link_to "詳細ページへ戻る", user_path(@user) %>
            </div>
          </div>
        </div>

      <% end %>
    </div>
  </div>
</div>